import{d as S,m as O,r,n as h,p as b,q as F,c as p,s as $,t as N,e as f,T as U,w as I,v as B,x as W,b as i,y as P,o as _,_ as w,z as H,A as y,B as j,C as G,h as C,D as J}from"./index-BsYwGHgQ.js";import{_ as K}from"./logo-CC90_112.js";const Q={class:"dialog-content"},Z=S({__name:"FloatingAvatar",props:{size:{default:60},hideThreshold:{default:30},dialogContent:{default:"你好，需要帮助吗？"},container:{default:null}},setup(a){const e=a;O(e,()=>{var n,u;console.log("props changed! ",e),e.container&&(s.value=(n=e.container)==null?void 0:n.getBoundingClientRect(),x.observe(e.container),s.value=e.container.getBoundingClientRect(),v.value=(u=l.value)==null?void 0:u.getBoundingClientRect())});const l=r(null),o=r(!1),c=r(!1),t=r({x:100,y:100}),d=r({x:0,y:0}),g=r(null),s=r(),v=r(),V=h(()=>({transform:`translate(${t.value.x}px, ${t.value.y}px)`,width:`${e.size}px`,height:`${e.size}px`,cursor:o.value?"grabbing":"grab"})),D=h(()=>{if(!e.container)return{};const n=e.container.offsetWidth;return{left:t.value.x>n/2?"auto":"100%",right:t.value.x>n/2?"100%":"auto"}}),E=n=>{g.value===null&&(g.value=n.touches[0].identifier,L(n.touches[0]))},A=n=>{const u=Array.from(n.touches).find(m=>m.identifier===g.value);u&&X(u)},k=()=>{g.value=null,z()},L=n=>{o.value=!0,d.value={x:n.clientX-t.value.x,y:n.clientY-t.value.y},window.addEventListener("mousemove",M),window.addEventListener("mouseup",z)},X=n=>{o.value&&R(n.clientX,n.clientY)},M=n=>{o.value&&R(n.clientX,n.clientY)},R=(n,u)=>{if(!e.container||!l.value)return;const m=n-d.value.x,q=u-d.value.y;t.value={x:Math.max(0,Math.min(m,s.value.width-v.value.width)),y:Math.max(0,Math.min(q,s.value.height-v.value.height))}},z=()=>{o.value=!1,window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",z),Y()},Y=()=>{if(!e.container||!l.value)return;const n=e.hideThreshold;t.value.x<n?t.value.x=-v.value.width+n:t.value.x>s.value.width-v.value.width-n&&(t.value.x=s.value.width-n),t.value.y<n?t.value.y=-v.value.height+n:t.value.y>s.value.height-v.value.height-n&&(t.value.y=s.value.height-n)},x=new ResizeObserver(()=>{!e.container||!l.value||(s.value=e.container.getBoundingClientRect(),v.value=l.value.getBoundingClientRect(),t.value.x=Math.min(t.value.x,s.value.width-v.value.width),t.value.y=Math.min(t.value.y,s.value.height-v.value.height))});return b(()=>{!e.container||!l.value||(x.observe(e.container),s.value=e.container.getBoundingClientRect(),v.value=l.value.getBoundingClientRect())}),F(()=>{x.disconnect()}),(n,u)=>(_(),p("div",{ref_key:"avatarElement",ref:l,class:"floating-avatar",style:$(V.value),onMousedown:L,onMouseenter:u[0]||(u[0]=m=>c.value=!0),onMouseleave:u[1]||(u[1]=m=>c.value=!1),onTouchstart:E,onTouchmove:A,onTouchend:k},[N(n.$slots,"avatarImage",{},void 0,!0),f(U,{name:"fade"},{default:I(()=>[B(i("div",{class:"dialog",style:$(D.value)},[i("div",Q,P(n.dialogContent),1),u[2]||(u[2]=i("div",{class:"dialog-arrow"},null,-1))],4),[[W,c.value]])]),_:1})],36))}}),ee=w(Z,[["__scopeId","data-v-5ab9eb0e"]]),te={},ne={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor"};function oe(a,e){return _(),p("svg",ne,e[0]||(e[0]=[i("path",{d:"M15 4a1 1 0 1 0 0 2V4zm0 11v-1a1 1 0 0 0-1 1h1zm0 4l-.707.707A1 1 0 0 0 16 19h-1zm-4-4l.707-.707A1 1 0 0 0 11 14v1zm-4.707-1.293a1 1 0 0 0-1.414 1.414l1.414-1.414zm-.707.707l-.707-.707.707.707zM9 11v-1a1 1 0 0 0-.707.293L9 11zm-4 0h1a1 1 0 0 0-1-1v1zm0 4H4a1 1 0 0 0 1.707.707L5 15zm10-9h2V4h-2v2zm2 0a1 1 0 0 1 1 1h2a3 3 0 0 0-3-3v2zm1 1v6h2V7h-2zm0 6a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2zm-1 1h-2v2h2v-2zm-3 1v4h2v-4h-2zm1.707 3.293l-4-4-1.414 1.414 4 4 1.414-1.414zM11 14H7v2h4v-2zm-4 0c-.276 0-.525-.111-.707-.293l-1.414 1.414C5.42 15.663 6.172 16 7 16v-2zm-.707 1.121l3.414-3.414-1.414-1.414-3.414 3.414 1.414 1.414zM9 12h4v-2H9v2zm4 0a3 3 0 0 0 3-3h-2a1 1 0 0 1-1 1v2zm3-3V3h-2v6h2zm0-6a3 3 0 0 0-3-3v2a1 1 0 0 1 1 1h2zm-3-3H3v2h10V0zM3 0a3 3 0 0 0-3 3h2a1 1 0 0 1 1-1V0zM0 3v6h2V3H0zm0 6a3 3 0 0 0 3 3v-2a1 1 0 0 1-1-1H0zm3 3h2v-2H3v2zm1-1v4h2v-4H4zm1.707 4.707l.586-.586-1.414-1.414-.586.586 1.414 1.414z"},null,-1)]))}const ae=w(te,[["render",oe]]),se=H("logs",()=>{const a=r([]),e=h(()=>a.value.length),l=h(()=>a.value),o=h(()=>t=>a.value[t]);function c(t){console.log("current log updated"),a.value=t,console.log("updateCurrentLogs:",a.value)}return{getLogs:l,getLength:e,getLog:o,updateCurrentLogs:c}}),T=H("chatSession",()=>{const a=r([]),e=r(0),l=h(()=>e.value),o=h(()=>a.value);function c(s){e.value=s}function t(s){a.value.push(s)}function d(s){a.value=a.value.filter(v=>v.session_id!=s)}function g(s){a.value=s}return{getSessions:o,addRecord:t,deleteRecord:d,refreshRecords:g,changeCurentSession:c,getCurSessionId:l}}),le={sendLog:async a=>await y.post("http://222.20.98.159:5180/chatLog",a),getChatSession:async(a=1e3)=>{const e=await y.get("http://222.20.98.159:5180/chatSession",{timeout:a});console.log("getChatSession Response:",e.data),T().refreshRecords(e.data.session)},getLog:async(a,e=1e3)=>{const l=se();await y.get(`http://222.20.98.159:5180/chatLog?session_id=${a}`,{timeout:e}).then(o=>{console.log("axios response: ",o.data),l.updateCurrentLogs(o.data.logs)}).catch(o=>{var c,t;o instanceof j&&(console.log((c=o.response)==null?void 0:c.status),console.log((t=o.request)==null?void 0:t.status))})}},ie={class:"wrapper"},ue={class:"content"},re=S({__name:"LogInput",setup(a){const e=T(),l=r(""),o=async()=>{console.log("inputLog!");const c=r({session_id:e.getCurSessionId,content:"test_content"}),t=await le.sendLog(c.value);e.changeCurentSession(t.data.session_id)};return(c,t)=>(_(),p("div",ie,[i("div",ue,[B(i("input",{type:"text",placeholder:"输入内容","onUpdate:modelValue":t[0]||(t[0]=d=>l.value=d)},null,512),[[G,l.value]])]),i("div",{class:"foot"},[t[1]||(t[1]=i("i",null,null,-1)),t[2]||(t[2]=i("i",null,null,-1)),i("i",{class:"enter",onClick:o},"what")])]))}}),ce=w(re,[["__scopeId","data-v-2a4fe1a3"]]),ve={class:"welcome-container"},de={class:"welcome-head"},he={class:"chat-input"},ge=S({__name:"index",setup(a){const e=r(null);return b(()=>{console.log("Home View Mounted!")}),(l,o)=>(_(),p("div",{class:"Home floating-container",ref_key:"floating_container",ref:e},[i("div",ve,[i("div",de,[i("i",null,[f(C(ae))]),o[1]||(o[1]=i("p",null,"我是Ai-assitant，很高兴见到你！",-1))]),o[2]||(o[2]=i("div",{class:"welcome-body"},[i("p",null,"test_2")],-1))]),i("div",he,[f(C(ce))]),f(C(ee),{size:60,"hide-threshold":40,container:e.value},{avatarImage:I(()=>[i("img",{alt:"虚拟形象",onDragstart:o[0]||(o[0]=J(()=>{},["prevent"])),src:K},null,32)]),_:1},8,["container"])],512))}}),pe=w(ge,[["__scopeId","data-v-b8b4c2d9"]]);export{pe as default};
