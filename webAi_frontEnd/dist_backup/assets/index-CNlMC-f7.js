import{d as V,r as h,c as $,e,f as s,w as t,j as f,o as w,_ as I,y as x,E as C,F as T,G as N,z as D,b as E}from"./index-BsYwGHgQ.js";import{r}from"./request-XtDRsfb_.js";const U={class:"schedule-table"},B=V({__name:"ScheduleTable",props:{scheduleData:{}},emits:["swap"],setup(n,{emit:d}){const y=d,o=h([{date:"2024-03-20",timeSlot:"08:00-12:00",employeeName:"张三",employeeId:1},{date:"2024-03-20",timeSlot:"12:00-16:00",employeeName:"李四",employeeId:2},{date:"2024-03-20",timeSlot:"16:00-20:00",employeeName:"王五",employeeId:3}]),_=u=>{y("swap",u)};return(u,c)=>{const l=s("el-table-column"),i=s("el-button"),a=s("el-table");return w(),$("div",U,[e(a,{data:o.value,style:{width:"100%"},border:"",stripe:"",size:"small"},{default:t(()=>[e(l,{prop:"date",label:"日期",width:"120",align:"center"}),e(l,{prop:"timeSlot",label:"时段",width:"180",align:"center"}),e(l,{prop:"employeeName",label:"值班人员",align:"center"}),e(l,{label:"操作",width:"120",align:"center"},{default:t(({row:m})=>[e(i,{type:"primary",size:"small",onClick:b=>_(m)},{default:t(()=>c[0]||(c[0]=[f(" 换班 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])}}}),F=I(B,[["__scopeId","data-v-7e9b2d89"]]),z={class:"employee-list"},L=V({__name:"EmployeeList",props:{employees:{}},emits:["delete"],setup(n,{emit:d}){const y=d,o=u=>({none:"无困难",normal:"一般困难",difficult:"特别困难"})[u]||u,_=u=>{y("delete",u)};return(u,c)=>{const l=s("el-table-column"),i=s("el-button"),a=s("el-table");return w(),$("div",z,[e(a,{data:u.employees,style:{width:"100%"}},{default:t(()=>[e(l,{prop:"name",label:"姓名",width:"120"}),e(l,{prop:"employeeId",label:"工号",width:"120"}),e(l,{prop:"economicStatus",label:"经济情况",width:"120"},{default:t(({row:m})=>[f(x(o(m.economicStatus)),1)]),_:1}),e(l,{prop:"availableTimes",label:"空闲时段"},{default:t(({row:m})=>[f(x(m.availableTimes.join(", ")),1)]),_:1}),e(l,{label:"操作",width:"120"},{default:t(({row:m})=>[e(i,{type:"text",onClick:b=>_(m.id)},{default:t(()=>c[0]||(c[0]=[f(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])}}}),j=I(L,[["__scopeId","data-v-978146a3"]]),q=V({__name:"InputForm",emits:["submit","cancel"],setup(n,{emit:d}){const y=d,o=h({name:"",employeeId:"",economicStatus:"none",availableTimes:[]}),_=["周一上午","周一下午","周二上午","周二下午","周三上午","周三下午","周四上午","周四下午","周五上午","周五下午","周六上午","周六下午","周日上午","周日下午"],u=()=>{y("submit",o.value)};return(c,l)=>{const i=s("el-input"),a=s("el-form-item"),m=s("el-option"),b=s("el-select"),g=s("el-button"),k=s("el-form");return w(),C(k,{model:o.value,"label-width":"120px"},{default:t(()=>[e(a,{label:"姓名"},{default:t(()=>[e(i,{modelValue:o.value.name,"onUpdate:modelValue":l[0]||(l[0]=p=>o.value.name=p)},null,8,["modelValue"])]),_:1}),e(a,{label:"工号"},{default:t(()=>[e(i,{modelValue:o.value.employeeId,"onUpdate:modelValue":l[1]||(l[1]=p=>o.value.employeeId=p)},null,8,["modelValue"])]),_:1}),e(a,{label:"经济情况"},{default:t(()=>[e(b,{modelValue:o.value.economicStatus,"onUpdate:modelValue":l[2]||(l[2]=p=>o.value.economicStatus=p)},{default:t(()=>[e(m,{label:"无困难",value:"none"}),e(m,{label:"一般困难",value:"normal"}),e(m,{label:"特别困难",value:"difficult"})]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"空闲时段"},{default:t(()=>[e(b,{modelValue:o.value.availableTimes,"onUpdate:modelValue":l[3]||(l[3]=p=>o.value.availableTimes=p),multiple:""},{default:t(()=>[(w(),$(T,null,N(_,p=>e(m,{key:p,label:p,value:p},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(a,null,{default:t(()=>[e(g,{type:"primary",onClick:u},{default:t(()=>l[5]||(l[5]=[f("提交")])),_:1}),e(g,{onClick:l[4]||(l[4]=p=>c.$emit("cancel"))},{default:t(()=>l[6]||(l[6]=[f("取消")])),_:1})]),_:1})]),_:1},8,["model"])}}}),v={getSchedules:()=>r.get("/api/schedules"),createSchedule:n=>r.post("/api/schedules",n),updateSchedule:(n,d)=>r.put(`/api/schedules/${n}`,d),deleteSchedule:n=>r.delete(`/api/schedules/${n}`),getEmployees:()=>r.get("/api/employees"),addEmployee:n=>r.post("/api/employees",n),updateEmployee:(n,d)=>r.put(`/api/employees/${n}`,d),deleteEmployee:n=>r.delete(`/api/employees/${n}`),generateSchedule:()=>r.post("/api/schedules/generate")},A=D("schedule",{state:()=>({schedules:[],employees:[],loading:!1,error:null}),actions:{async addEmployee(n){await v.addEmployee(n),await this.fetchEmployees()},async deleteEmployee(n){await v.deleteEmployee(n),await this.fetchEmployees()},async generateSchedule(){this.schedules=(await v.generateSchedule()).data},async fetchEmployees(){this.employees=(await v.getEmployees()).data},async getSchedules(){return await v.getSchedules()},async getEmployees(){return await v.getEmployees()}}}),G={class:"schedule-container"},H={class:"card-header"},J={class:"tab-content"},K={class:"tab-content"},M=V({__name:"index",setup(n){const d=A(),y=h("schedule"),o=h(!1),_=h([]),u=h([]),c=async i=>{await d.addEmployee(i),o.value=!1,_.value=(await d.getSchedules()).data,u.value=(await d.getEmployees()).data},l=async i=>{await d.deleteEmployee(Number(i)),_.value=(await d.getSchedules()).data,u.value=(await d.getEmployees()).data};return(i,a)=>{const m=s("el-button"),b=s("el-tab-pane"),g=s("el-tabs"),k=s("el-card"),p=s("el-dialog");return w(),$("div",G,[e(k,{class:"schedule-card"},{header:t(()=>[E("div",H,[a[5]||(a[5]=E("span",{class:"title"},"排班系统",-1)),e(m,{type:"primary",onClick:a[0]||(a[0]=S=>o.value=!0)},{default:t(()=>a[4]||(a[4]=[f("添加员工")])),_:1})])]),default:t(()=>[e(g,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=S=>y.value=S),class:"schedule-tabs"},{default:t(()=>[e(b,{label:"排班表",name:"schedule"},{default:t(()=>[E("div",J,[e(F,{"schedule-data":_.value},null,8,["schedule-data"])])]),_:1}),e(b,{label:"员工列表",name:"employees"},{default:t(()=>[E("div",K,[e(j,{employees:u.value,onDelete:l},null,8,["employees"])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(p,{modelValue:o.value,"onUpdate:modelValue":a[3]||(a[3]=S=>o.value=S),title:"添加员工",width:"50%"},{default:t(()=>[e(q,{onSubmit:c,onCancel:a[2]||(a[2]=S=>o.value=!1)})]),_:1},8,["modelValue"])])}}}),Q=I(M,[["__scopeId","data-v-8c7a75b9"]]);export{Q as default};
